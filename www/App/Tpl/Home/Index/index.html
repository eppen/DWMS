<!DOCTYPE html>

<html lang="zh-cn">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="__PUBLIC__/image/favicon.png">

    <title>危险废物管理信息系统</title>

    <!-- Bootstrap core CSS -->
    <link href="__PUBLIC__/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="__PUBLIC__/css/signin.css" rel="stylesheet">
    <script type="text/javascript" src="__PUBLIC__/js/jquery-2.0.3.min.js"></script>
    <script type="text/javascript" src="__PUBLIC__/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="__PUBLIC__/js/yourAlert.js"></script>
    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../docs-assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="http://cdn.bootcss.com/html5shiv/3.7.0/html5shiv.min.js"></script>
      <script src="http://cdn.bootcss.com/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
</head>

<body style="background:url(__PUBLIC__/image/bg_3.jpg) no-repeat;  background-color:#3D80AD;">
    <div class="container" style="width:65%;">
        <div class="panel panel-primary" id="login-panel">
            <div class="panel-heading"></div>
            <div class="panel-body" style="border-radius:500px">
                <form style="width:37%;" role="form" id="login">
                    <div class="blank-div"></div>
                    <h2 class="form-signin-heading txt-shadow">危险废物管理信息系统</h2>
                    
                    <div class="blank-div"></div>
                    <div class="blank-div"></div>
                    <input id="username" type="username" name="username" class="form-control" placeholder="用户名" required="" autofocus="" />

                    <input type="password" name="password" class="form-control" placeholder="密码" required="" />
                    <div class="row">
                        <div class="col-xs-7">
                            <input type="code" name="code" class="form-control" placeholder="验证码" required="" />
                        </div>
                        <div class="col-xs-2">
                            <img src="{:U('Home/Index/verify/')}" id="code" />
                        </div>
                        <div class="col-xs-3">
                            <small><a href="javascript:void(change_code());">看不清</a>
                            </small>
                        </div>
                    </div>
                    <!-- <label class="checkbox">
                <input type="checkbox" value="remember-me">记住密码
            </label> -->
                    
                    <div class="blank-div"></div>
                    <div id="myAlert"></div>
                    
                </form>
               <!--  <button class="btn btn-lg btn-primary btn-block" onclick="login()">登 录</button>
                    <button type="button" class="btn btn-success btn-lg btn-block" id="register" data-toggle="modal" data-target="#myModal">注 册</button> -->
                <div class="container" style="width:40%;">
                <center>
                    <button class="btn btn-lg btn-primary btn-block" onclick="login()">登 录</button>
                    <button type="button" class="btn btn-success btn-lg btn-block" id="register" data-toggle="modal" data-target="#myModal">注 册</button>
                </center>
                </div>
            
                <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="padding-top:15%">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                <h4 class="modal-title" id="myModalLabel"><b>请选择要注册的角色:</b>
                                </h4>
                            </div>
                            <div class="modal-body">
                                <big>

                                    <div class="radio" onclick="regOpt=0;">
                                        <label>
                                            <input type="radio" name="optionsRadios">生产单位
                                        </label>
                                    </div>
                                    <div class="radio" onclick="regOpt=1;">
                                        <label>
                                            <input type="radio" name="optionsRadios">运输单位
                                        </label>
                                    </div>
                                    <div class="radio" onclick="regOpt=2;">
                                        <label>
                                            <input type="radio" name="optionsRadios">接受单位
                                        </label>
                                    </div>
                                </big>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                                <button type="button" class="btn btn-primary" onclick="do_reg()">去注册</button>
                            </div>
                        </div>
                        <!-- /.modal-content -->
                    </div>
                    <!-- /.modal-dialog -->
                </div>
                <!-- /.modal -->
                <footer class="bs-footer" role="contentinfo">
                    <div class="text-center padder clearfix txt-shadow">
                        <div class="blank-div"></div>
                        <div class="blank-div"></div>
                        Copyright © 2014-2015
                        <br/>
                        <span class="glyphicon glyphicon-send"></span>
                        <b>SJTU OMNILab</b>
                    </div>

                </footer>
            </div>
        </div>
    </div>
    <!-- /container -->

    <!-- Placed at the end of the document so the pages load faster -->
    <!-- jQuery core JavaScript -->

    <!-- My JavaScript-->


    <script type="text/javascript">
    var verifyURL = "{:U('Home/Index/verify/', '', '')}";
    </script>
    <script type="text/javascript" src="__PUBLIC__/js/login.js"></script>

    <script type="text/javascript">
    regOpt = -1;

    function do_reg() {
        // var regList = ["/index.php/Home/Register/index?id=production", "/index.php/Home/Register/index?id=transport", "/index.php/Home/Register/index?id=reception"];
        var regList = ["{:U('Home/Register/index?id=production')}", "{:U('Home/Register/index?id=transport')}", "{:U('Home/Register/index?id=reception')}"];
        if (regOpt < 0) {
            throw_exception('未选择角色');
            alert("请选择角色");
        }

        location.href = regList[regOpt];

    }

    function login(){
    var form_serialize = "" + $('#login').serialize();
    console.log(form_serialize);
    $.ajax({
        type: "post",
        url: "{:U('Home/Index/login/')}",
        data: form_serialize,
        success: function(data) {
            // $("#model-content").html(data);
            console.log(data);
            data = parseInt(data);
            switch(data){
                case 0:
                    window.location.assign("./index.php/Home/LoginAdmin/homepage.html");
                    break; 
                case 1:
                    window.location.assign("./index.php/Home/LoginCountry/homepage.html");
                    break; 
                case 2:
                    window.location.assign("./index.php/Home/LoginProvince/homepage.html");
                    break; 
                case 3:
                    window.location.assign("./index.php/Home/LoginCity/homepage.html");
                    break; 
                case 4:
                    window.location.assign("./index.php/Home/LoginDistrict/homepage.html");
                    break;  
                case 5:
                    window.location.assign("./index.php/Home/LoginProduction/homepage.html");
                    break;  
                case 6:
                    window.location.assign("./index.php/Home/LoginTransport/homepage.html");
                    break;  
                case 7:
                    window.location.assign("./index.php/Home/LoginReception/homepage.html");
                    break;
                case 8:
                    myAlertFail("验证码错误");
                    break; 
                case 9:
                    myAlertFail("用户名或密码错误！");
                    break;
                case 10:
                    myAlertFail("您的审核还未通过，请耐心等待。。");
                    break;
                case 11:
                    myAlertFail("用户被锁定，请联系当地环保部门。。");
                    break;
                
                default :
                    myAlertFail("登录失败");
            }
        },
        error: function(XMLHttpRequest, textStatus, errorThrown) {
            console.log("Error:Ajax_Content_Load" + errorThrown);
            console.log("XMLHttpRequest.status:" + XMLHttpRequest.status);
            console.log("XMLHttpRequest.readyState:" + XMLHttpRequest.readyState);
            console.log("textStatus:" + textStatus);
        }
    });
}
    </script>
</body>

</html>
